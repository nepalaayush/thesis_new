% !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
%                                                                            !
% Adapt this file so that you can use it for your thesis					 !
%                                                                            !
% !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!


\documentclass{micro-econ-thesis}
\usepackage{graphicx}
\usepackage{setspace}
\usepackage{float}
\usepackage[utf8]{inputenc} % depends on the font encoding that you are using

\usepackage{pdfpages}
\usepackage{gensymb}
\usepackage{amsmath}
\usepackage{booktabs}

\usepackage{chngcntr}
\usepackage{caption}

\counterwithout{table}{section}


% For formatting of your bibliography, please use the following package with options 
\usepackage[style=authoryear-icomp, maxcitenames=1, minbibnames = 3, maxbibnames=5, backend=biber, uniquelist=false ]{biblatex}

\addbibresource{bibliography.bib} % add a bib-reference file

\AtEveryBibitem{\clearfield{day}}



\begin{document}
% ----------------------------------------------------------------------------
% Details for the titlepage
% ----------------------------------------------------------------------------
\thesisTitle{Development of Analysis Techniques for Dynamic Magnetic Resonance Imaging of the Knee}
\thesisType{Master Thesis} % 'Master Thesis' or 'Seminar Paper'
\thesisAuthor{Aayush Nepal}
\thesisMail{aayush.nepal@uni-jena.de}
\thesisGrade{Master of Science in Medical Photonics} % leave empty for seminar papers
\thesisTutora{Prof. Dr. rer. nat. med. habil. Jürgen Reichenbach}
\thesisTutorb{Dr. rer. nat. Martin Krämer}
\thesisMatrikel{198683}
%\thesisAddress{}
\thesisDate{June 11, 2024}
% In case of external supervisor
\thesisCompany{}

% Print titlepage
\thesisMakeTitle

% ----------------------------------------------------------------------------
% Abstract
% ----------------------------------------------------------------------------
\cleardoublepage
\pagenumbering{roman}
\pagestyle{plain}
%\thispagestyle{empty}
\subsection*{Abstract}

The knee joint, a critical component of human movement, is often exposed to mechanical loads that can lead to degenerative conditions such as osteoarthritis (OA). OA, prevalent globally and particularly affecting the knee, requires early diagnosis for effective intervention. Magnetic resonance imaging (MRI) has proven effective in detecting soft tissue changes, but conventional MRI studies often miss early-stage OA indicators as conventional static MRI measurements are conducted under non-weight-bearing conditions, unlike the actual physiological state during daily activities.

This thesis leverages recent advancements in MRI technology to analyze the knee joint under mechanical loading, using high-resolution CINE MRI imaging. This approach enables the investigation of dynamic interactions between the femur and tibia during flexion-extension cycles and provides potential insights into knee kinematics. A major challenge in this process is the accurate segmentation of anatomical structures, over multiple time frames, which is critical for reliable biokinematic measurements. To address this, a semi-automated segmentation pipeline was developed to streamline the process and improve consistency across sequential images.

Following segmentation, biokinematic parameters such as the angle between the long axes of the femur and tibia and the distance between anatomical landmarks were quantified under various loading conditions. The results showed significant variations in distance measurements during the early phase of flexion, highlighting the knee's sensitivity to external loading. However, no significant differences were found in the angle measurements, suggesting stable bone alignment under loading.

This research demonstrates the potential of semi-automated segmentation for efficient and reliable analysis of dynamic knee MRI scans, offering potential benefits for clinical and research applications. Despite the promising findings, the study's use of single 2D slices limits the comprehensive assessment of knee kinematics. Future work should extend this methodology to 3D analyses and explore its application to patellofemoral kinematics to gain a more holistic understanding of knee mechanics.

In conclusion, this thesis presents a robust method for analyzing knee joint kinematics using advanced MRI techniques, paving the way for improved diagnostic and research opportunities in orthopedics.

\clearpage
\subsection*{Acknowledgements}
I would like to sincerely express my heartfelt gratitude to all those who have made significant contributions to the completion of this thesis.

First and foremost, I am deeply grateful to my supervisors, Prof. Dr. Jürgen Reichenbach, and Dr. Martin Krämer, for their unwavering support, guidance, and expertise throughout the entire research process. Their valuable feedback, mentorship, and scholarly insights have been instrumental in shaping the direction and quality of this study.


I would like to extend my sincere appreciation to the participants of this research: Jon, Helena, Marta, Uday, and Nick. Thank you for volunteering your time and effort to participate in this project.
 
 
I am also indebted to Dr. Karl-Heinz Hermann and Dr. Daniel Güllmar for their expert advice and valuable contributions. Their extensive knowledge and thoughtful suggestions have greatly enriched my research.

I would like to thank Renat for his invaluable assistance with programming and data visualization. 

I am grateful to Jon and Wan-Ting for their camaraderie and for making our time in the research group enjoyable.

I would also like to acknowledge Uniklinikum Jena for providing the necessary resources and facilities that enabled my research.


I am also grateful to all the faculty members of Medical Photonics and FSU Jena for their teachings, mentorship, and intellectual guidance, which have significantly contributed to my growth and development as a researcher.
 

To Shreya, thank you for your love and support throughout this journey.

To my father, Kumar Prasad Nepal, without whom I would not be here.

Although it is impossible to mention everyone individually, please know that your unwavering support, contributions, and encouragement have been indispensable to the successful completion of this thesis.

Once again, thank you all for your enduring support and encouragement.

% ----------------------------------------------------------------------------
% Table of contents
% ----------------------------------------------------------------------------
\cleardoublepage
%\thispagestyle{empty}
\tableofcontents

% ----------------------------------------------------------------------------
% List of figures/tables
% ----------------------------------------------------------------------------
\cleardoublepage
\phantomsection
\addcontentsline{toc}{section}{List of Figures}
\listoffigures
% --------------------------
\cleardoublepage
\phantomsection
\addcontentsline{toc}{section}{List of Tables}
\listoftables
% --------------------------

\cleardoublepage
\phantomsection
\addcontentsline{toc}{section}{List of Acronyms}
\section*{List of Acronyms}
\begin{tabular}{@{}ll}
ADMM & Alternating Direction Method of Multipliers \\
BMI & Body Mass Index \\
Cov & Covariance matrix \\
FFT & Fast Fourier Transform \\ 
FLASH & Fast Low Angle Shot \\
FID & Free Induction Decay \\
FoV & Field of View \\
GRE & Gradient Echo \\
MRI & Magnetic Resonance Imaging \\
OA & Osteoarthritis\\
PCA & Principal Component Analysis \\
SEM & Standard Error of the Mean \\
SHM & Screw Home Mechanism \\
TE & Echo Time \\
TGV & Total Generalized Variation \\
TR & Repetition Time 

\end{tabular}

% --------------------------

% ----------------------------------------------------------------------------
% Contents
% ----------------------------------------------------------------------------
\cleardoublepage
\pagestyle{headings}
\pagenumbering{arabic}
\setcounter{page}{1}
% Contents
\onehalfspacing % for linespacing 1.5, you can turn it off with \singlespacing, e.g. for quotes or tables with multiline cells

\section{Introduction}

The knee joint, a crucial structure in human movement, consists of various tissues with distinct structural and mechanical properties, including articular cartilage and meniscus. These components are regularly subjected to mechanical pressure loads, making them susceptible to degenerative conditions such as osteoarthritis (OA). OA affects a significant portion of the global population and the knee joint is one of the most common targets, leading to functional impairments and increased healthcare costs \parencite{WHO}. A comprehensive survey across 15 European countries and Israel found that knee pain is the third most commonly reported type of chronic pain, underscoring the significant public health concern it represents \parencite{breivik_survey_2006}. Furthermore, OA was identified as the most common cause of this pain. This situation has not improved over time. In Germany, for instance, a recent retrospective study found that the number of patients with OA is steadily rising \parencite{obermuller_epidemiology_2024}. As society ages, the prevalence and impact of OA are expected to rise, posing significant public health challenges \parencite{yelin_burden_2016}. Knee-related issues are prevalent and impactful due to the inherent complexity of the knee joint. As a hub of various anatomical structures working in unison, the knee supports a range of movements and bears significant loads, making it susceptible to a variety of injuries and conditions. Early diagnosis of OA is crucial for timely intervention, and understanding the anatomy of the knee is the first step in tackling this problem. Magnetic resonance imaging (MRI) has emerged as a promising non-invasive technique for early diagnosis of OA due to its excellent soft tissue contrast and high spatial resolution \parencite{kijowski_osteoarthritis_2020}. 

Conventionally, MRI studies aimed at assessing the structure and function of the knee joint have been performed with the joint at rest or under non-weight-bearing conditions, which, however, do not accurately reflect the physiological state of the knee during daily activities \parencite{blankevoort_envelope_1988}. For instance, research has shown that bone marrow lesions, which are associated with OA progression, are significantly related to mechanical loading during activities like walking, highlighting the limitations of non-weight-bearing MRIs in detecting early-stage OA \parencite{bennell_bone_2010}. 

Given these limitations, the development of dynamic MRI techniques has become essential to more accurately reflect the knee's behavior under realistic conditions. For example, one dynamic MRI study demonstrated that knee kinematics during continuous movement reveal significant differences in several parameters---such as tibial abduction, internal rotation, anterior translation---compared to static positions \parencite{dentremont_dynamicbased_2013}. Additionally, studies like Mahmoudian et al. (2017) have shown that both dynamic and static knee alignments are predictive of structural abnormalities on MRI associated with medial compartment knee osteoarthritis, underscoring the clinical relevance of dynamic imaging techniques \parencite{mahmoudian_dynamic_2017}. 

Various studies on tibiofemoral kinematics of the knee in motion using dynamic MRI have been conducted.  For example, Conconi et al. (2023) used a low-field MRI to study the knee in deep flexion under weight-bearing conditions, manually segmenting static images and using an automated system to track bone movement in dynamic scans. \parencite{conconi_-vivo_2023}. Similarly, Lansdown et al. (2014) compared three methods for measuring knee movement using T2-weighted MRI images, evaluating the reproducibility of these methods for tracking certain knee movements Their study aimed to evaluate the reproducibility of these methods for measuring anterior tibial translation and internal tibial rotation \parencite{lansdown_reproducibility_2015}. In another study, Kaiser et al.\,(2013) utilized a 3D MR sequence to acquire dynamic volumetric images. They created subject-specific bone models from high-resolution static images and registered these to the dynamic images to measure 3D tibiofemoral translations and rotations during knee flexion-extension cycles, using a knee loading device to simulate the load acceptance phase of gait \parencite{kaiser_measurement_2013}. Mazzoli et al.\,(2017) developed a different method for capturing high-resolution, images of the knee without needing external triggers. They scanned the knee during a flexion/extension task using a special sampling technique and imaging sequence to collect data. Kinematic parameters were derived through a two-step rigid registration process of the segmented femur and tibia masks from high-resolution anatomical scans \parencite{mazzoli_accelerated_2017}.

Despite these innovative approaches, several studies share common limitations that warrant further consideration. For instance, Mazzoli et al.\,(2017), Kaiser et al.\,(2013), d'Entremont et al.\,(2013), and Conconi et al.\,(2023) all rely on high-resolution static scans to create models of the bones, which are then combined with dynamic scans to derive kinematic parameters. The need to acquire a static scan in addition to the dyanamic scans increases the overall scanning time and complexity of the procedure, which might make them impractical for routine clinical use. Moreover, manual segmentation of musculoskeletal tissues, where an operator delineates the boundaries of each joint structure on every MR image slice, is a widely used but extremely time-consuming process. The efficiency and repeatability of the process is dependent on the operator's level of experience \parencite{mcwalter_use_2005}. For example, Lansdown et al.\,(2014) highlight these challenges, noting that the segmentation process for the femur and tibia in both extended and flexed positions took up to 144 minutes. On the other hand, machine learning techniques like Convolutional Neural Networks and U-Nets are being widely used to automate the segmentation process \parencite{liu_deep_2018}. Unfortunately, these methods typically require large annotated datasets for training, which are not available for the dynamic knee imaging performed in these projects.

To address these limitations, this thesis aims to develop a semi-automated pipeline specifically designed to segment the tibia and femur from dynamic MRI of the knee. This pipeline processes high-resolution single-slice 2D images in the sagittal view, captured during the flexion-extension cycle of the knee under different loading conditions. Additionally, the methodology will track and analyze specific kinematic parameters—such as the angle between the long axes of the tibia and femur segments and the distance between specific anatomical landmarks on these bones—throughout the motion cycle. This analysis will investigate how these kinematic parameters change under loaded and unloaded conditions.

The expected outcomes of this thesis are twofold. First, the development of the semi-automated segmentation pipeline will eliminate the need for high-resolution static scans to model the bone, relying solely on dynamic images themselves. This approach is anticipated to significantly reduce the overall scanning time and complexity of the procedure, making it more practical for routine clinical use. Additionally, by automating the segmentation process, the pipeline aims to reduce the time and variability associated with manual segmentation, enhancing both efficiency and repeatability.

Second, by conducting this study on healthy volunteers, the analysis will establish normative trends in knee joint kinematics under various loading conditions. These benchmarks will serve as crucial reference points for future comparisons with patient data, aiding in the early diagnosis and treatment of conditions like osteoarthritis. Establishing these normative trends will be essential for assessing knee joint stability and functionality. 

This thesis is structured as follows: Chapter \ref{sec:fundamentals} delves into the fundamentals of the knee joint and dynamic MRI, providing the necessary anatomical and technical background. Dynamic MRI is further subdivided into sections on CINE imaging, Gating, Knee loading device, Gradient echo FLASH sequence and radial golden-angle acquisition. Chapter \ref{sec:methods} outlines the methodology, detailing the data collection, MRI sequence parameters, and the development of the semi-automated segmentation pipeline.  Chapter \ref{sec:results} presents the results, highlighting the performance of the edge-tracking algorithm and the biokinematic analysis under varying loading conditions. Chapter \ref{sec:discussion} discusses the findings in detail, and explores their clinical implications.
Finally, Chapter \ref{sec:conclusion} concludes the thesis with a summary of key contributions, limitations of the experimental setup and suggestions for future research directions. In particular, Chapters \ref{sec:results} and \ref{sec:discussion} are organized to clearly delineate the topics of edge tracking and segmentation, angle calculation, and distance calculation, in that order. 

\section{Fundamentals}
\label{sec:fundamentals}


\subsection{The Knee Joint }

The knee joint is the largest and the most superficial synovial joint in the body \parencite{dalley_moores_2023}. The anatomy of the knee joint includes several important structures such as bones, cartilage, and ligaments. These components work together to provide stability and flexibility to the joint. Figure \ref{fig:kniearthrosekniegelenk-anatomieenjpg} illustrates the anatomy of the right knee joint, highlighting these key structures.
\begin{figure}[H]
	\centering
	\includegraphics[width=0.7\linewidth]{kniearthrose_kniegelenk-anatomie_enjpg}
	\caption{Anatomy of the right knee joint showing bones, cartilage, and ligaments. Left: front view; Right: side view. Key structures include the femur (thigh bone), tibia (shinbone), fibula (calf bone), patella (kneecap), articular cartilage, meniscus, and various ligaments such as the cruciate ligaments, lateral collateral ligament, and medial collateral ligament. \parencite{informedhealth2021}}
	\label{fig:kniearthrosekniegelenk-anatomieenjpg}
\end{figure}

 
It consists of three compartments that form a dynamic, specialized hinge joint \parencite[p.1395]{standring_grays_2021}. These compartments are the medial compartment, the lateral compartment, and the patellofemoral compartment.
Each compartment contains primary articulations that contribute to the joint's biomechanical performance. Specifically, the knee comprises two femorotibial articulations—one in the medial compartment and one in the lateral compartment (see Figure \ref{fig:rightkneeplate519})—and one femoropatellar articulation in the patellofemoral compartment (see Figure \ref{fig:patellarsurface}). These articulations are defined by their complexity and incongruence. 
 
\begin{figure}[H]
	\centering
	\includegraphics[scale=0.3]{right_knee_labeled}
	\caption{Anterior (top, showing the knee in flexion) and posterior (bottom, showing the knee in extension) views of the right knee, with labeled articular surfaces of the medial and lateral condyles. [Edited] \parencite[p.519]{netter_519_2023}}
	\label{fig:rightkneeplate519}
\end{figure}

\begin{figure} [H]
	\centering
	\includegraphics[scale=0.3]{patellar_surface}
	\caption{Right knee joint opened, with the knee in a slightly flexed position, exposing the articular surface of the patella.[Edited] \parencite[p.517]{netter_519_2023}}
	\label{fig:patellarsurface}
\end{figure}

This design allows the knee to manage a wide range of movements and bear significant loads. Figure \ref{fig:sixdegrees} illustrates the knee's capacity for multidimensional movement, highlighting the joint's sophisticated structural design that enables this versatility. However, this inherent design also renders the knee vulnerable to a range of forces, including compressive forces acting on bone and cartilage, tensile stresses in periarticular ligaments, and substantial muscular forces required to maintain balance during weight-bearing activities. \parencite{standring_grays_2021} For instance, during symmetrical stance on both feet, each knee supports approximately 43 \% of the body's weight, necessitating precise muscular coordination to maintain balance \parencite{maquet2012biomechanics}.

\begin{figure}[H]
	\centering
	\includegraphics[width=0.7\linewidth]{six_degrees}
	\caption{The knee joint motion in three dimensions, described with six degrees of freedom: anterior/posterior translation, medial/lateral shift, compression/distraction, abduction/adduction, flexion/extension, and medial/lateral rotation. The arrows indicate the direction of each movement. \parencite[p.~1412]{standring_grays_2021}.}
	\label{fig:sixdegrees}
\end{figure}

Such mechanical forces, influenced by activities and body mass index (BMI), are significant causes of OA and represent one of the most modifiable risk factors \parencite{heidari_knee_2011}. Both static and dynamic forces play critical roles in the pathophysiology of OA. Static forces, such as those experienced while standing, contribute significantly to mechanical stress on the knee joint, exacerbating the risk of OA \parencite{egloff_biomechanics_2012}. Additionally, abnormal joint loading during movement is a key mechanical driver of osteochondral changes that contribute to the initiation and progression of knee OA \parencite{coburn_immediate_2023}.


The relationship between biomechanical stresses and knee health highlights the need for diagnostic tools that fulfill two key criteria: they must capture the knee's dynamic behavior during motion and assess the joint under varying loads. Dynamic MRI is emerging as a notable imaging modality that meets these criteria \parencite{conconi_-vivo_2023}. 


\subsection{Dynamic MRI}
In a broad sense, dynamic MRI is an umbrella term encompassing various MRI techniques designed to capture and visualize physiological processes and motion over time. The dynamic aspect of MRI is crucial for studying biological systems or body structures involving inherent motion, such as blood flow, tissue perfusion, or cardiac activity. For the purposes of this project, the focus of "dynamic MRI" narrows down to capturing the bulk movement of the knee joint undergoing active flexion extension cycles inside the scanner. Compared to traditional static MRI scans, which are highly susceptible to motion artifacts compared to other imaging modalities \parencite{zaitsev_motion_2015}, dynamic MRI techniques can not only record motion, but can even leverage it to offer comprehensive insights into the functional and biomechanical properties of the structures in question.  Among these techniques, CINE imaging, particularly renowned in cardiac MRI, is considered the gold standard for evaluating cardiac function \parencite{menchon-lara_reconstruction_2019}. Its high status in cardiac MRI demonstrates the method's precision and adaptability—traits that are leveraged in dynamic knee imaging.

\subsubsection{CINE Imaging}

The word CINE, derived from 'cinematography,' refers to creating a movie-like sequence of images. In the context of dynamic knee MRI, this technique can be used to reconstruct a "movie" of a single flexion/extension cycle. This visualization is achieved by aggregating multiple partial datasets acquired over various cycles. The knee's movement cycle is segmented into distinct stages, each corresponding to a specific angle of flexion or extension. For each stage, k-space — the Fourier transform space from which MR images are reconstructed — is incrementally sampled. This data is gathered across multiple repetitions of the movement cycle, ensuring comprehensive coverage of k-space and thus, high-resolution imaging of each movement phase.This technique works robustly only if the movement cycles of the knee during imaging are sufficiently reproducible to each other \parencite{curtis_primer_2022}. Achieving this consistency in dynamic MRI of the knee, which naturally involves significant movement variations, requires precise synchronization of the imaging process with the knee's motion cycle. 

\subsubsection{Gating} 

This synchronization, known as gating, aligns image acquisition with specific, repeatable points in the knee's movement cycle. By synchronizing image acquisition with specific phases of the knee's movement cycle, gating allows for accurate reconstruction of the dynamic movements of the knee, enabling precise biokinematic analyses. There are two main types of gating: retrospective and prospective gating. In prospective gating, image acquisition is triggered at specific points in the motion cycle in real-time. For this project, retrospective gating was used, where the data is acquired continuously throughout the motion cycle \parencite{edelman_clinical_1996} and then reordered post-acquisition into a coherent sequence that captures the knee at different positions throughout the motion cycle. This necessitates external information that captures the precise moment and position of the knee throughout its range of movement. An MR-safe knee loading device equipped with an optical sensor attachment was used to provide this vital information, including the exact timing and degree of knee flexion and extension \parencite{brisson_novel_2022}. 

\subsubsection{Knee Loading Device }

The MR-safe knee loading device employed in this study is illustrated in Figure \ref{fig:kneedevice}. This device allows for a range of motion of approximately 25 to 45 degrees (subject-dependent), enabling subjects to perform knee flexion and extension cycles under both loaded and unloaded conditions. For loading, the device is equipped with compartments for weight plates and sandbags, that allow a physiological load of 10 to 12 kilograms. These weights are positioned at the end of the device near the subject's lower limb. As the subject extends the leg, they must overcome not only the natural inertia of their body weight but also the additional external load imposed by these weights. Similarly, as the subject flexes the leg from the extended position, they have to lower the leg in a controlled manner, which also requires effort. 

\begin{figure}[H]
	\centering
	\includegraphics[width=0.9\linewidth]{knee_device}
	\caption{A 3D rendering of the knee motion/loading device (left) and two photographs of the device in a Siemens Magnetom Prisma Fit MRI scanner (right). The top right image (rear view) demonstrates how the distal part of the device sits atop the rails within the scanner bore, which are normally used to guide and support the patient table. The bottom right image (front, oblique view) demonstrates an individual positioned in the device with a flexible coil around the index knee, the thigh secured between the proximal pillow blocks and the ankle fastened to the leg support, as well as the coil plug setup. (figure and figure caption taken from \cite{brisson_novel_2022}) }
	\label{fig:kneedevice}
\end{figure}

Central to this device's functionality is an optical fiber position sensor (MR338-Y10C10, Micronor, 155 Camarillo, CA, USA), which precisely  measures the ab­solute angle from 0{\degree}\,to 360\degree \, with a resolution of 0.025\degree \parencite{rickenbach_optical_2013}. This measurement capability is critical for synchronizing the knee's movement with MRI data reconstruction. 
\begin{figure} [H]
	\centering
	\includegraphics[width=0.7\linewidth]{sensor_img}
	\caption{The MR330 controller (left) and MR338 optical fiber position sensor system (right), connected via duplex LC multimode fiber optic cabling, with a maximum distance of up to 300 meters. The setup illustrates the separation between the outside MRI area and the MRI-safe area.}
	\label{fig:sensorimg}
\end{figure}


As shown in Figure \ref{fig:sensorimg}, the MR330 controller interfaces with the MRI-safe MR338 position sensor to facilitate precise measurements in the MRI environment, using up to 300 meters of fiber optic cabling. The controller is connected to an acquisition computer placed outside the scanner while the sensor is attached to the device itself. The MR338 rotary encoder continuously monitors the knee's rotation angle using optical signals, which are converted into electrical signals by the MR330 controller. These electrical signals are then sent to the RedLab 1208LS (Meihaus Electronic GmbH), a USB-based data acquisition module designed for measuring analog and digital signals (refer to Figure \ref{fig:redlab}). The MRI scanner outputs trigger signals for each sequence repetition as a voltage signal, which are also captured by the RedLab 1208FS-Plus. Both the knee rotation signals and the trigger signals are simultaneously sampled by the RedLab 1208FS-Plus and then transmitted to the acquisition computer via USB. The acquisition computer converts these signals into binary data, which is later used for reconstructing the synchronized knee motion and MRI data.  
\begin{figure}[H]
	\centering
	\includegraphics[scale=0.1]{redlab}
	\caption{The RedLab 1208LS module, a USB data acquisition device by Meihaus Electronic GmbH. This unit, shown with attached USB cable, converts optical to electrical signals for MRI applications}
	\label{fig:redlab}
\end{figure}




To improve the signal-to-noise ratio and provide comprehensive coverage of the knee joint, two flexible coils (Variety 16-channel multifunctional coil, Noras MRI products GmbH), as shown in Figure \ref{fig:coils}, were positioned at key anatomical locations: one at the distal femur and the other at the proximal tibia, as specified in the MRI protocol. 

\begin{figure}[H]
	\centering
	\includegraphics[scale=0.2]{coils}
	\caption{Noras Variety 16 channel flex coils. The image shows the flex coils with a central square exterior featuring Velcro fastener for secure strapping, highlighting its flexible design.}
	\label{fig:coils}
\end{figure}
  
For imaging, a previously reported radial golden-angle gradient-echo Fast Low-Angle Shot (FLASH) sequence was used, which is more robust against motion artifacts than Cartesian sequences \parencite{aleksiev_high-resolution_2022}. The following sections will detail the key components of this technique: radial golden-angle acquisition and the gradient-echo FLASH sequence.

\subsubsection{Gradient Echo FLASH Sequence}

\textbf{Basics}

At its core, MRI is an imaging technique based on the interaction of nuclear spins with a static homogeneous external magnetic field \textbf{($B_0$)}. The primary nucleus used in MRI is the proton in hydrogen, which precesses around the direction of this external field.  When there are many protons in the magnetic field, a net distribution of the magnetic moments of the protons develop, with magnetic moments along the field slightly more likely than orientations with magnetic moments opposed to the field, resulting in a net magnetization vector (\textbf{$M_z$}) along the field direction. Imaging the human body relies on manipulating and detecting the bulk precession of these hydrogen spins in water, fat, and other organic molecules \parencite{brown_magnetic_2014}. These manipulation are achieved through various temporal sequences of magnetic field gradients, radiofrequency pulses, and data acquisition periods. 


One such commonly used sequence is the gradient echo (GRE) sequence. Like any other sequence, the GRE sequence begins with the application of a radiofrequency (RF) pulse. This RF pulse is an oscillating magnetic field that is applied perpendicular to the static field \textbf{$B_0$}. It is tuned to match the Larmor frequency $\omega_0$ , the natural precession frequency of the hydrogen protons in the magnetic field. The Larmor frequency is given by the equation:
\begin{equation}
	\omega_0 = \gamma B_0
	\label{eq:larmor}
\end{equation}
where $\gamma$ is the gyromagnetic ratio and $B_0$ is the external magnetic field.
When this frequency matching occurs, the protons resonate with the RF pulse, causing the net magnetization vector (\textbf{$M_z$}) to tip from the longitudinal axis into the transverse plane, creating a transverse magnetization \textbf{$M_{xy}$}. This is where the term "resonance" in Magnetic Resonance Imaging originates. 

\textbf{$M_{xy}$} generates the detectable MRI signal by inducing an oscillating voltage in the receiver coils, which is known as free induction decay (FID). However, to form a meaningful image, it is essential to encode spatial information into this signal. This spatial encoding is achieved through the use of pulsed gradient magnetic fields applied in various directions. These gradients alter the precession frequencies of the protons depending on their spatial positions, thus allowing the mapping of the location of the signals in the body.  

\textbf{The three gradient fields}

The first gradient field applied is the slice-selecting gradient ($G_{SS}$). It is generally applied in the direction of \textbf{$B_0$}, simultaneously with the application of the RF pulse. 
This gradient varies the magnetic field strength along the z-axis, causing the protons to precess at different frequencies according to Equation \ref{eq:larmor}. As a result, only the protons located at a specific point along the z-axis, where their Larmor frequency matches with the RF pulse frequency, will resonate. This resonance tips these protons into the transverse plane, effectively selecting a specific slice for imaging. Immediately after the RF pulse and $G_{SS}$, a rephasing gradient with opposite polarity in the slice-selecting direction is applied. The purpose of this rephasing lobe is to correct for any dephasing of magnetization across the slice caused by the initial  $G_{SS}$. When the initial gradient is applied, protons within the selected slice experience slightly different magnetic field strengths, causing them to dephase during the application of the RF pulse. The rephasing gradient lobe reverses this effect by applying a gradient of the same magnitude but opposite polarity, bringing the spins back into phase in the selected slice. This ensures that \textbf{$M_{xy}$} is coherent at the end of this slice selection process, maximizing the strength of the detectable signal.

Once the slice is selected, signal localization along the remaining two perpendicular directions in the transverse plane must be performed. The process begins with frequency encoding. Another gradient field, let's say in the x-direction, called the frequency encoding gradient (\textbf{$G_{FE}$}), is applied simultaneously during signal acquisition. When this gradient is applied, protons experience different precession frequencies based on their spatial location along the x-axis. The sampled signal will be a superposition of these frequencies, which can be resolved by performing an inverse Fast Fourier Transform (FFT) to reconstruct the spatial information along the x-direction. Before the main \textbf{$G_{FE}$} is applied during acquisition, a gradient of opposite polarity, known as the prephasing gradient, is briefly applied. This prephasing gradient slightly dephases the spins, establishing a known initial phase relationship. When the main frequency encoding gradient is subsequently applied, it causes the spins to rephase, forming an echo signal at a specific time. This rephasing process generates the "gradient echo," which is the reason for naming this sequence as it is. The prephasing gradient is typically shorter and is followed by the longer main frequency encoding gradient, ensuring that the spins are coherently rephased at the echo time, maximizing the strength of the detected signal.

Phase encoding is performed to spatially encode information along the second perpendicular (y) direction. The phase encoding gradient \textbf{($G_{PE}$)} is briefly turned on and then off before $G_{FE}$ is applied. During the time $G_{PE}$ is on, the spins start precessing at different frequencies based on their spatial location along the y-axis, causing them to dephase. When $G_{PE}$ is turned off, the spins return to precessing at the Larmor frequency, but the phase differences induced by the gradient remain. 

After this initial encoding, the same sequence is repeated multiple times. Each repetition is identical except for the magnitude of the phase encoding gradient $G_{PE}$, which is varied systematically. By altering the strength of $G_{PE}$ with each repetition, different phase shifts are induced, corresponding to different spatial locations along the y-axis. This process effectively samples spatial information across the entire y-direction. The collected data from these repetitions fill what is known as k-space, a matrix that represents the spatial frequency domain of the image. Each line in k-space corresponds to a different phase encoding step. Once k-space is fully sampled, an inverse 2D FFT is performed to convert the frequency-domain data into a spatial-domain image. This combination of frequency encoding and phase encoding allows for the reconstruction of a two-dimensional image of the selected slice.

\textbf{FLASH}

In GRE pulse sequences, the temporal placement of dephasing and rephasing gradients along the frequency encoding direction without a waiting period for the echo—unlike in spin-echo sequences—allows for significantly shorter TE, thereby facilitating faster imaging  \parencite[p.94]{westbrook_mri_2019}. However, certain applications, such as dynamic MRI of moving body parts like the leg, demand even quicker acquisition times. To meet these demands, the Fast Low Angle Shot (FLASH) GRE sequence can be used \parencite{haase_flash_1986}. FLASH employs low flip angle RF pulses, which reduce the time needed for the longitudinal magnetization to recover, thereby enabling also shorter repetition times (TR). 

Another important aspect of FLASH sequences is the management of residual transverse magnetization before the next RF excitation pulse in the sequence. In gradient echo sequences, after a series of RF pulses, the system reaches a condition known as the steady state. In this state, the magnitude of $M_z$ is the same at the end of each TR period. However, there can also be residual $M_{xy}$ at the start of each repetition cycle. If this residual transverse magnetization is not managed, it can interfere with the signal and degrade image quality. To address this, FLASH sequences incorporate a strong spoiler gradient in the slice-selecting direction. This gradient deliberately dephases the residual transverse magnetization, ensuring that it does not contribute to the signal in subsequent cycles. By effectively "spoiling" the transverse magnetization, the sequence starts fresh with each repetition, reducing artifacts and enhancing image quality.

A typical FLASH sequence diagram is shown in Figure \ref{fig:gresimplified}, illustrating the application of low flip angle RF pulses, frequency encoding gradients, and the spoiler gradient.

\begin{figure}[H]
	\centering
	\includegraphics[width=0.7\linewidth]{flash_seq}
	\caption{FLASH sequence diagram. The diagram illustrates the key components of the FLASH sequence: RF pulse with flip angle $\alpha^\circ$, slice-selecting gradient ($G_{SS}$), phase encoding gradient ($G_{PE}$), frequency encoding gradient ($G_{FE}$), Signal, and spoiler gradient, echo time (TE) and repetition time (TR)}
	\label{fig:gresimplified}
\end{figure}

\subsubsection{Radial Golden-Angle Acquisition}


Radial golden-angle acquisition refers to a special modification of how k-space is sampled. Unlike traditional static MRI, which typically employs Cartesian line-by-line sampling, this method utilizes radial sampling. Here, the data points are collected along radial lines spreading out from the center of k-space, resembling spokes on a wheel. Figure \ref{fig:radial} depicts a generic radial sampling scheme. The separation between any two adjacent circles defines the separation $\Delta k_r$ in the radial sampling direction, whereas, the angular separation between any two successive angular lines in k-space (such as between the two example lines shown in the figure) defines $\Delta \theta$. The two quantities $\Delta k_r$ and $\Delta \theta$ are constrained by the Nyquist sampling criterion \parencite{brown_magnetic_2014}. 
  
 \begin{figure}[H]
 	\centering
 	\includegraphics[scale=0.4]{k_space_2}
 	\caption{Generic radial k-space sampling diagram featuring multiple spokes (solid black lines) of data acquisition. The diagram includes concentric circles representing lines of constant k-space radii. The axes $k_x$ and $k_y$ indicate the spatial frequencies. $\Delta \theta$ represents the angular separation between adjacent spokes. The orange dots distributed along each spoke are the individual k-space readout points (adapted from p.306 \cite{brown_magnetic_2014} )  }
 	\label{fig:radial}
 \end{figure}
 
 The 'golden-angle' strategy, which was used in this work, optimizes this approach by spacing the radial lines at an angle of approximately 111.25 degrees. This specific angle helps in continuously covering k-space without overlapping lines, ensuring that each new image frame provides unique information. 
 
\begin{figure}[H]
	\centering
	\includegraphics[width=0.7\linewidth]{golden_angle_figure}
	\caption{Radial k-space sampling strategies. (a) Fixed angular increment ($\phi = 180^\circ / 10$), showing potential for uneven k-space coverage. (b) Golden-angle sampling ($\phi_{GR} = 111.25^\circ$), ensuring uniform distribution across k-space as the number of projections ($P$) increases \parencite{winkelmann_optimal_2007}.}
	\label{fig:goldenanglefigure}
\end{figure}

 
Figure \ref{fig:goldenanglefigure} provides a visual comparison between the traditional fixed increment method and the golden-angle method for k-space sampling. It illustrates how each approach affects the distribution of sampling lines in k-space. In the figure, part (a) shows radial sampling using a fixed angular increment. This method can lead to gaps or overlaps in data collection, depending on the number of radial profiles and the angle increment used. Part (b) demonstrates the golden-angle method, where each new radial line is placed at an increment of approximately 111.25 degrees. This approach allows for a more uniform distribution of sampling lines in k-space, enhancing image quality by preventing gaps and reducing redundancy in data collection. Figure \ref{fig:kspacearrow} is an example of the k-space data acquired during a specific frame of the knee flexion cycle along with  the reconstructed MRI image in real space obtained by applying an inverse 2D FFT to the k-space data.
\begin{figure}[H]
	\centering
	\includegraphics[scale=0.3]{kspace_arrow_2}
	\caption{Left: Exemplary magnitude of k-space data acquired during a specific frame of the knee flexion cycle. Right: Reconstructed MRI image in real space obtained by applying an inverse 2D Fast Fourier Transform (2D IFFT) to the k-space data}
	\label{fig:kspacearrow}
\end{figure}
  


\section{Methodology}
\label{sec:methods}

\subsection{Data Collection Methods}

\subsubsection{Procedure Details}
Dynamic MRI scans were conducted on seven healthy individuals, two females and three males, ranging in age from 28 to 39 years and weighing between 55 to 90 kilograms, using a 3 T Siemens Prisma scanner (Siemens Healthineers AG). Subjects were free of any known musculoskeletal disorders and provided their written informed consent, in compliance with the ethical standards approved by the institutional review board. For all of these subjects, the left leg was scanned. However, the data analysis was ultimately performed on datasets from only five of these subjects.


Once the subject was positioned supine in the scanner, the thigh was secured on a wedge positioner with a strap, and the lower leg was attached to an ankle support, just above the malleoli, using Velcro straps to minimize lateral movement. The knee to be examined was aligned with the device’s axis of rotation, while the other leg rested alongside the MRI scanner's bore.  Knee motion was guided by a belt and sprocket assembly running alongside the lower leg, connected to a gearbox activated by the leg support as the participant flexed and extended the knee. Once the subject was positioned at the scanner's isocenter, their leg naturally assumed a flexed posture due to the design of the device. In this configuration, the leg is cradled by the device arm which is positioned below the level of the knee, ensuring that the leg remains flexed without the volunteer exerting any force.


The volunteers engaged in a controlled exercise, following a metronome set at 60 beats per minute. This pace dictated a four-beat extension-to-flexion cycle, with the leg being flexed at the first beat and fully extended by the fourth. This equals to 8 beats per cycle, or 7.5 cycles every minute. Initially conducted under a loaded condition, the process was repeated without the added resistance to compare both states. The scan duration was 160 seconds, amounting to 20 full flexion-extension-flexion cycles. The range of motion for each dataset is noted in Table \ref{tab:range_of_motion}. 

\begin{table}[H]
	\centering
	
	\caption{Range of Motion for Different Datasets}
	\label{tab:range_of_motion}
	\begin{tabular}{cc}
		\toprule
		Dataset & Range of Motion (°) \\
		\midrule
		1 & 38 \\
		2 & 30 \\
		3 & 36 \\
		4 & 36 \\
		5 & 46 \\
		\bottomrule
	\end{tabular}
	
	
\end{table}

\subsubsection{Sequence Parameters and Reconstruction}
Table \ref{tab:mri_seq_params} lists the MRI sequence parameters:

\begin{table}[H]
	\centering
	
	\caption{MRI Sequence Parameters}
	\label{tab:mri_seq_params}
	\begin{tabular}{@{}ll@{}}
		\toprule
		Sequence Parameters & Values \\ \midrule
		Acquisition Duration & 160 [s] \\
		Dwell Time & 0.0024 [ms] \\
		Echo Time & 2.51 [ms] \\
		Field Strength & 2.89362 [T] \\
		Flip Angle & 8.0 [deg] \\
		Field of View (FOV) & 192.0 x 192.0 x 3.0 [mm] \\
		Frequency & 123.25 [MHz] \\
		Matrix Size & 176 x 176 x 1 \\
		Repetition Time & 5.8 [ms] \\
		\bottomrule
	\end{tabular}
\end{table}

In this study, the k-space data was acquired using 16 receive channels, with each channel recording data simultaneously but having a unique spatial sensitivity profile. 276 spokes were used to sample one complete k-space. With a TR of 5.8 milliseconds per spoke, it took approximately 1.6 seconds to acquire one k-space. Over the course of the experiment, 100 such k-space repetitions were acquired, equating to 100 repetitions as noted. The total scan duration either under loaded or unloaded conditions was 160 seconds. Based on participant feedback, this duration was reported to be manageable for performing the exercise. 

Each acquired k-space repetition contained data across a range of knee flexion angles because of the continuous leg movement set to the metronome beat. Assuming subjects performed perfectly in time at 60 beats per minute, it takes 4 seconds to move the leg from maximum flexion to full extension. Since one k-space acquisition took 1.6 seconds, this duration was not enough to capture sufficient data to fully reconstruct frames at any specific flexion angle. Therefore, to reconstruct the full range of knee angles accurately,  100 k-space repetitions were acquired. 
    
\textbf{Reconstruction}

The MRI raw data, with dimensions of (352, 276, 16, 100), was processed using a reconstruction pipeline to generate the final image dataset. The dimensions correspond to: 
\begin{itemize}
	\item 352: The number of data points per spoke.
	\item 276: The number of spokes used to sample a k-space dataset.
	\item 16: The number of receive channels
	\item 100: The number of k-space repetitions acquired over the course of the experiment.
\end{itemize}

In addition to the raw MRI data, the binary data from the acquisition computer, which included both the optical sensor readings and the MRI scanner trigger signals, was loaded. This binary data was read and parsed to extract the knee rotation angles (in degrees) and the MRI trigger signals in a usable format. By detecting significant changes in the trigger signals, the start of new k-space repetitions were identified. The knee rotation angles were then grouped according to each k-space repetition based on these trigger signals. This resulted in 100 groups, each containing a range of knee rotation angle information for a specific k-space repetition. 

For each k-space repetition, the spokes were categorized based on the knee rotation angles, divided into 2-degree intervals. This means that each reconstructed frame covered a 2-degree segment of knee motion. This process was repeated for the entire range of motion, ensuring a comprehensive coverage.  

Image reconstruction was then performed on each newly formed k-space dataset. The number of spokes within each 2-degree angle range varied between 300 and 1000. The direction of leg movement—either flexion, where the leg moves downward, or extension, where the leg moves upward—was determined by calculating the slope of the angle data. Images were reconstructed separately for each direction, as the biokinematics of moving downward (flexion) versus upward (extension) differs significantly.  

\textbf{Non cartesian image reconstruction (RIESLING)}

Iterative image reconstruction is a computational method used in various imaging modalities, including MRI, to enhance image quality. Unlike direct reconstruction techniques, iterative methods repeatedly refine the image by comparing the acquired data with an estimated version of the image, making adjustments to minimize the difference between the two. This process allows for better handling of incomplete or noisy data, effectively reducing artifacts and suppressing noise, which contributes to improved image quality. Non-Cartesian MRI, such as spiral or radial imaging, involves sampling data along non-linear trajectories in the k-space, rather than the traditional grid pattern. This non-uniform sampling can complicate image reconstruction because the data are not evenly spread across the k-space, leading to potential artifacts and gaps in information. Iterative reconstruction is advantageous in this context because it can more effectively interpolate missing data and reduce artifacts by iteratively adjusting the image based on the available non-linearly sampled data \parencite{block_undersampled_2007}.

To implement these iterative reconstruction methods, the actual image reconstruction was done by using the RIESLING (Radial Interstices Enable Speedy Low-Volume imagING)   reconstruction toolbox \parencite{wood2020riesling}. This toolbox offers a range of advanced algorithms tailored for non-Cartesian MRI reconstruction. In this study, an Alternating Direction Method of Multipliers (ADMM) approach was employed \parencite{MAL-016}, incorporating Total Generalized Variation (TGV) regularization \parencite{tgv}. 

ADMM is an iterative optimization algorithm that breaks down complex problems into smaller subproblems to solve them efficiently. It ensures accurate reconstruction by maintaining a balance between the primal (actual solution) and dual (approximate solution) residuals. This balance is particularly important for non-Cartesian MRI reconstruction, given the unique geometry of the data. ADMM allows different regularization techniques, like TGV, to be applied simultaneously during reconstruction . 

TGV is an advanced regularization method that reduces noise while promoting smoothness in the reconstructed images. Unlike basic Total Variation (TV) regularization, TGV allows for piecewise smooth transitions between different regions, making it better suited for images with varied structures. In this study, a regularization strength of 0.05 was chosen empirically, striking a balance between noise suppression and edge sharpness.

Each image frame was reconstructed with dimensions of (528, 528) and the number of frames was dependent on the range of motion achieved by each individual within the scanner bore.


\subsection{Data Analysis}
All analyses and data visualizations were done using the Python programming language (v3.11.5). Several distinct steps were performed to semi-automate the segmentation of the tibia and femur. This involved first finding one boundary edge for each of the bones, and then tracking them throughout the full extension -flexion cycle. This is achieved by computing transformation matrices that map the movement of each boundary edge from one frame to the next throughout the cycle. 
 
\subsubsection{Segmentation}
The semi-automatic segmentation process was achieved in five distinct steps as described below: 

\textbf{Step 1: Edge Detection}

The Canny filter \parencite{canny_computational_1986}, as implemented in the scikit-image's feature library (v0.21.0), was employed to apply an edge filter to the images. The Canny edge detection algorithm operates through several key steps to identify edges with high accuracy in images. Initially, the image is smoothed using a Gaussian filter to reduce noise and potential false edge detections. Following this, the algorithm calculates the gradient magnitude and direction of the image brightness at each pixel, which helps identifying the edges boundaries. This is done by differentiating the image in two orthogonal directions and computing the gradient magnitude as the root sum of
squares of the derivatives. The gradient direction is computed using the arctangent of the ratio of the derivatives.

Subsequently, the algorithm applies double thresholding to the gradient magnitudes, which involves two thresholds: a low and a high. This creates three categories of pixels: strong, weak, and non-edges. Pixels with intensities above the high threshold are marked as strong edge pixels, while those below the low threshold are considered to be non-edges. Pixels between these two thresholds are marked as weak edge pixels. Weak edge pixels are potentially converted into strong edges through a process known as hysteresis, where only those weak edges that are connected to strong edges are confirmed as true edges. In this context, hysteresis refers to the algorithm's reliance on the connectivity history of pixels to decide their edge status, ensuring that only meaningful, connected edges are preserved \parencite{heath_robust_1997}.  

To optimize the edge detection specifically to capture the desired edges of the tibia and femur, different parameters like the standard deviation of gaussian blur ($\sigma$) and the upper and lower thresholds were tested in different combinations. The optimal results were achieved with a low threshold between 0 to 5 and a high threshold between 6 to 10, while a value of 2 was used for $\sigma$. Figure \ref{fig:edgemitimg} displays the output of the edge detection with these parameters.  
\begin{figure}[H]
	\centering
	\includegraphics[width=0.7\linewidth]{edge_new}
	\caption{Output of the Canny edge detection algorithm applied to one of the frames, showing the detected edges (white) overlayed on top of the original image for visual comparison.}
	\label{fig:edgemitimg}
\end{figure}


Subsequently, the scikit-image's morphology library was utilized to remove small elements from the binary image. The image was then skeletonized to a one-pixel width, retaining only long and consistent edges. It should be pointed out that the final edge does not necessarily need to span the entire boundary of the interior edge of the cortical bone; even partial edges were successfully used for this purpose.  

\textbf{Step 2: Labeling}

For the final selection of the desired edges, a labeling algorithm (`ndimage.label`) from SciPy, an open-source Python library designed for scientific computing (version 1.11.3), was used. The purpose of employing this labeling algorithm was to effectively isolate specific structural features, such as distinguishing the interior cortical bone from the exterior, by assigning unique labels to separate closely situated edges detected in the image. This algorithm utilizes the principle of connected-component labeling, a method used in computer vision to detect connected regions in binary digital images \parencite{dillencourt_general_1992}. The connected-component labeling algorithm scans an image and groups its pixels into components based on pixel connectivity, meaning that all pixels in a connected component share similar pixel values and are adjacent to each other.

The labeling process treats any non-zero values in the input array as part of potential edges and zero values as background. The connectivity of these components is determined by a structuring element, which in this case was a fully connected $3\times3\times3$ matrix. This structuring element ensures that each voxel (3D pixel) is connected to its 26 immediate neighbors (including those connected by faces, edges, and vertices), known as 26-way connectivity.

Each voxel is therefore connected to its 26 immediate neighbors, providing consistent labeling across frames and reducing the need for manual adjustments in the analysis. Alternatives, such as a structuring element with less connectivity, worked fine for a single frame but gave inconsistent labels across the 3D dataset. Using the 26-way connectivity ensured consistent labeling across all frames in the stack of 2D images. 

Figure \ref{fig:labelimg} shows the output from the labelling algorithm for a given frame, where each color represents a separate label. 

\begin{figure}[H]
	\centering
	\includegraphics[width=0.7\linewidth]{label_selected}
	\caption{Output from the labeling algorithm with the representative edges for femur (top) and tibia(bottom) highlighted. Distinct colors represent a different label identified by the labeling algorithm.}
	\label{fig:labelimg}
\end{figure}
 
After choosing the appropriate labels, a binary image for each frame was obtained, where the foreground has the boundary for the interior edge of tibia and femur, and the background has intensity value of zero.   

\textbf{Step 3: Obtaining the set of reference points}

After isolating the binary edge images of the tibia and femur in Step 2, the next task involved identifying a set of reference points along these binary edges. Captured when the knee was fully flexed, this reference frame served as the baseline for further analysis, with transformations initially set to zero.  Establishing these reference points ensured a consistent basis for accurately calculating rigid transformations between subsequent frames. The densely packed unordered binary edge data would have been computationally cumbersome and less precise for such transformations.

To begin, the points along the boundary were organised in a systematic manner by sorting. This was done by first, defining a starting point, and then iteratively using a greedy nearest neighbor algorithm for sorting \parencite{Hinneburg2000neare-5849}. The most distal point of the bone was taken as the initial seed. The algorithm then selected the nearest neighboring point as the next point in the sequence. It continued to do this iteratively—choosing the closest point that had not been selected yet—until all points were sorted in a path that followed the boundary of the bone.

Once the points were sorted, the next step involved downsampling these points to a set of uniform equidistant reference points along the boundary of the binary edge. Directly sampling every n-th point from the sorted list did not suffice, as it resulted in uneven spacing due to the variable distances between consecutive points in the original boolean data.

The first step in this process was calculating the cumulative distances between each consecutive pair of points in the sorted list. Using these distances, a total path length was established. The desired interval between the new points was then determined by dividing this total path length by the number of intervals (number of desired points minus one). 

Determining the optimal number of points—ranging between 50 to 80—was established through trial and error. Fewer than 50 points often compromised the accuracy of the edge overlap by failing to capture the essential contours of the bone. Conversely, exceeding 80 points did not significantly enhance the algorithm's accuracy but increased the computation time slightly. 

To ensure that the positions of the points adhered closely to the original curve, while remaining equidistant, the cubic spline interpolation from SciPy's interpolate library was used. This routine used interpolation to add and place points based on the criteria mentioned above. 
Figure \ref{fig:downsampled} depicts this result. 
\begin{figure}[H]
	\centering
	\includegraphics[width=0.7\linewidth]{downsampled}
	\caption{A close-up view of the equidistantly sampled points (orange) along the boundary of the tibia edge (white) after completion of the sorting and downsample routine. }
	\label{fig:downsampled}
\end{figure}

\textbf{Step 4: Transformation matrices computation}

In this step, a set of transformation matrices was obtained, each containing the parameters that aligned the reference points from one frame to the next. These transformations included solely translations in the sagittal plane and rotations about the transverse axis perpendicular to the sagittal plane. This approach assumed that the bone did not undergo any deformation and that through-plane motion was negligible throughout the motion cycle. 

Mathematically, the transformation of each point from one frame to the next can be expressed as 
\begin{equation}
	\mathbf{p'} = \mathbf{R}(\phi) \mathbf{p} + \mathbf{t}
	\label{eq:rot} 
\end{equation}
where: 
\begin{itemize}
	\item $\mathbf{p}$ is the position vector of the point in its current frame
	\item $\mathbf{p'}$ is the position vector of the point after transformation
	\item $\phi$ is the angle of rotation
	\item $\mathbf{R}(\phi)$  is the rotation matrix, given by 
	 \[
	 \mathbf{R}(\phi) = 
	 \begin{bmatrix}
	 	\cos \phi & -\sin \phi \\
	 	\sin \phi & \cos \phi
	 \end{bmatrix}
	 \]
	 
	 \item $\mathbf{t}$ is the translation vector,
	 	\[
	 	t = \begin{bmatrix}
	 		\Delta x \\
	 		\Delta y
	 	\end{bmatrix}
	 	\]
 	\item $\Delta x$ and $\Delta y$ are the translations in the Cartesian coordinate system. 
\end{itemize}   
Only three parameters, $x$, $y$, and $\phi$ needed to be computed. To determine these parameters, a cost function was defined. This function, denoted as $C(x,y,\phi)$, quantified the alignment error by calculating the 'cost' of deviations for any given set of transformation parameters. The minimization of this cost identified the combination of parameters that achieved the best alignment or overlap of the transformed frame with the reference frame. A lower value of the cost function output indicated a closer match to the target frame, suggesting a better alignment, whereas a higher value signified a less accurate alignment. The equation of the cost function is given in Equation \ref{eq:cost_func}:  
\begin{equation}
	C(\Delta x, \Delta y, \phi) = \sum_{p=1}^{N} \min_{q \in Q} \left( \sqrt{(x_q - x_p')^2 + (y_q - y_p')^2} \right)
	\label{eq:cost_func}
\end{equation}
where:
\begin{itemize}
	\item $ (x_p, y_p) $ are the coordinates of the points in the reference frame
	\item $(x_p', y_p')$ are the coordinates of points after having been transformed:
	\begin{align*}
		x_p' &= \Delta x + x_p \cos(\phi) - y_p \sin(\phi) \\
		y_p' &= \Delta y + x_p \sin(\phi) + y_p \cos(\phi)
	\end{align*}
	\item $(x_q, y_q)$ are the coordinates of points in the target frame.
	\item $N$ is the number of points in the reference frame, and $Q$ represents all points in the target frame.
\end{itemize}

This cost function evaluates the alignment of transformed coordinates to target coordinates by calculating the sum of the shortest distances from each point in the transformed frame to the closest point in the target frame. Each $(x_p', y_p')$ represents the position of a point from the reference frame after having been transformed by the parameters $\Delta x$, $\Delta y$, and $\phi$. For each transformed point, the distance to every point $(x_q, y_q)$ in the target frame is computed, the minimum of these distances is selected, and the sum of these minimum distances is calculated over all points. This sum is the output of the cost function, which was optimized in the following step. 

The optimization of this cost function was performed using a nonlinear least squares approach where the initial guess of [0,0,0] was provided. This guess represented the starting values for the transformation parameters $\Delta x$, $\Delta y$ and $\phi$. The \texttt{fmin} function from SciPy’s optimization module was used for this purpose, which uses the Nelder-Mead simplex method \parencite{nelder_simplex_1965}. The algorithm was used with a function tolerance and a parameter tolerance of $1 \times 10^{-8}$, and a maximum of 1000 iterations. This method iteratively explored the parameter space to find the set of parameters that resulted in the lowest cost function value. The optimization procedure continued until the change in the cost function was less than the specified tolerance or the maximum number of iterations was reached, indicating convergence to an optimal solution. Figure \ref{fig:edge_tracking} provides a visual representation of the overlap of the reference points from the fully flexed initial position to the frame where the lower leg has been rotated by an angle of 12 degrees as reported by the rotary angle encoder. 
\begin{figure}[H]
	\centering
	\includegraphics[width=0.7\linewidth]{image137}
	\caption{Left: The reference points in the first frame (orange) overlaid with the binary edge image of the target frame (white). Right: The reference points have been transformed by using the results from the optimization showing almost perfect overlap, illustrating the effective alignment achieved through the minimization of the cost function.}
	\label{fig:edge_tracking}
\end{figure}

The transformation matrices were obtained iteratively, where each set of transformed reference points served as the basis for the next iteration. Ultimately, a list of these matrices was obtained, containing information for each adjacent frame. 


\textbf{Step 5: Application of transformation matrices }

With the transformation matrices obtained from edge tracking, any shape drawn on the first frame can be transformed across the subsequent frames. If the initial edge detection covers the entire boundary of the bone, no further manual input is required, and the segmentation process is considered complete. However, for datasets where only a partial chunk of the full interior boundary of the bone (generally for the tibia) was found by edge detection, manual segmentation was necessary. This is illustrated in Figure \ref{fig:manualsegment}, which shows the tibia's boundary extended manually to complete the segmentation. 

\begin{figure} [H]
	\centering
	\includegraphics[width=0.7\linewidth]{manual_segment}
	\caption{Manual segmentation was performed to complete the boundary of the tibia's interior edge shown in green, along with the reference points (orange).}
	\label{fig:manualsegment}
\end{figure}

Using the shapes of these manually drawn segments, the transformation matrices were then applied to perform automatic segmentation in all subsequent frames. 

\textbf{Evaluation of Edge tracking algorithm}

To evaluate the precision of edge tracking achieved through cost function minimization, the deviation of the overlap between points on the transformed frame and the target frame was measured. 

The mean alignment error per point was derived by dividing the cost function output by the total number of points in the transformed frame. This value quantifies the average distance that a point on the transformed frame deviated from its corresponding point on the target frame. This value was calculated for all frames, and the average across all points and frames was determined for each dataset.

To assess the variability of these mean alignment errors across different datasets, the Standard Error of the Mean (SEM) was calculated using the following formula:
\begin{equation}
	\text{SEM} = \frac{\sigma}{\sqrt{n}}
\end{equation}
where $\sigma$ is the standard deviation of the mean alignment errors within each dataset, and $n$ is the number of frames analyzed per dataset.

\subsubsection{Extraction of Biokinematic Parameters}
After achieving automated segmentation of the tibia and femur across all frames, the next step involved extracting biokinematic parameters from the segmented regions. Two key metrics were considered for analysis to assess the relationship between these bones throughout the flexion-extension cycle captured in the 2D CINE images.

The first metric calculated the angle between the long axis of femur and tibia segments, providing insight into how the relative orientation of the two bones changed over time.

The second metric assessed the distance between specific anatomical landmarks on both the femur and tibia. Tracking this distance across the frames offered an understanding of how the spatial relationship between these two bones evolved during the motion cycle. 

\textbf{Angle between the bones}

To calculate the angle between the bones, the long axis of each bone segment was identified using Principal Component Analysis (PCA) \parencite{jolliffe_principal_2004}. The analysis was performed using the PCA implementation from the scikit-learn (v1.3.1) Python library, a module for machine learning built on top of SciPy.

PCA determines the direction of maximum variance in the data, which coincides with the longitudinal axis of the bone. To perform PCA, the coordinates of the segmented binary mask were used as input. First, the centroid of the shape was calculated. This centroid was then subtracted from each data point, effectively centering the data. As a result of this transformation, the mean of the centered data points was shifted to (0, 0), meaning that the average position of all the data points was at the origin of the coordinate system. 

Next, the covariance matrix (\text{Cov}) was computed, a square matrix that gives an indication of how the data varies along each dimension and how different dimensions vary together. 

\begin{equation}
	\mathbf{Cov} = 
	\begin{bmatrix}
		\mathrm{Var}(X) & \mathrm{Cov}(X,Y) \\
		\mathrm{Cov}(Y,X) & \mathrm{Var}(Y)
	\end{bmatrix}
	\label{eq:cov}
\end{equation}

where:
\begin{itemize}
	\item \(\mathrm{Var}(X)\) is the variance of \(X\), given by:
	\[
	\mathrm{Var}(X) = \frac{1}{N-1} \sum_{p=1}^{N} (X_{p} - \bar{X})^2,
	\]
	where \(N\) is the number of points, \(X_{p}\) represents the \(p^{th}\) point in the \(X\) dimension, and \(\bar{X}\) is the mean value of all points in the \(X\) dimension. 
	\item \(\mathrm{Cov}(X,Y)\) is the covariance between dimensions \(X\) and \(Y\), defined as:
	\[
	\mathrm{Cov}(X,Y) = \frac{1}{N-1} \sum_{p=1}^{N} (X_{p} - \bar{X})(Y_{p} - \bar{Y}),
	\]
	where \(Y_{p}\) represents the \(p^{th}\) point in the \(Y\) dimension, and \(\bar{Y}\) is the mean value of all points in the \(Y\) dimension.
	
	\item \(\mathrm{Cov}(Y,X)\) and  \(\mathrm{Var}(Y)\) are equal to their counterparts because the covariance matrix is symmetric. 

\end{itemize}


When this covariance matrix is applied to a vector, the matrix transforms the vector such that it aligns with the direction of maximum variance in the dataset. Therefore, by computing the matrix's eigenvectors and eigenvalues, the vectors representing the direction of maximum variance are identified. The first principal component refers to the eigenvector associated with the largest eigenvalue. In figure \ref{fig:longaxes}, the longitudinal axis of femur and tibia are shown. 

\begin{figure}[H]
	\centering
	\includegraphics[width=0.7\linewidth]{theta_angle_new}
	\caption{The long axis of the bones are identified by using the PCA (blue) along with the centroid (white cross) for each segment. $\theta$ represents the obtuse angle between the vectors of the axes.}
	\label{fig:longaxes}
\end{figure}

The angles between the segments were calculated by using the dot product between unit vectors:

\begin{equation}
	\theta = \arccos(\mathbf{U}_{\text{fem}} \cdot \mathbf{U}_{\text{tib}})
	\label{eq:angle}
\end{equation}
where, $\mathbf{U}_{\text{fem}}$ and $\mathbf{U}_{\text{tib}}$ are the unit vectors of the longitudinal axes for the femur and tibia segments respectively. The range of $\theta$, the angle between the femur and tibia, spans from 90° to 180°. As the knee extends, this angle increases up to 180°. Should it extend beyond this angle, the excess is added rather than subtracted, allowing the visualization of angles exceeding 180°. 

\textbf{Distance between the bones}

To quantify the spatial relationship between the bones, anatomical landmarks on the femur and the tibia were chosen. For the femur, the most distal point on its segment was selected, and for the tibia, a  proximal point lying in the notch was chosen, as illustrated in Figure \ref{fig:twopoints}.   
\begin{figure}[H]
	\centering
	\includegraphics[width=0.7\linewidth]{two_points}
	\caption{Segmented femur and tibia displayed in solid gray, superimposed on the knee's MRI image at a specific point in the flexion cycle. The anatomical landmarks on the femur and tibia are marked in yellow}
	\label{fig:twopoints}
\end{figure}

These points were selected based on their consistent availability and reliable identification in the chosen MRI slices of each dataset.

The euclidean distance between the femur landmark ($x_2, y_2$) and the tibia landmark ($x_1, y_1$) was measured by using Equation \ref{eq:distance}. 
\begin{equation}
	d = \sqrt{(x_2 - x_1)^2 + (y_2 - y_1)^2}
	\label{eq:distance}
\end{equation} 


\textbf{Normalizing the time axis for analysis and graphical purposes}

Even though the number of frames was consistent between the loaded and unloaded conditions for a given dataset, the total number of frames reconstructed varied across different datasets due to the varying ranges of motion achieved by the subjects inside the scanner during the experiment. 

The variation in frame count necessitated the normalization of the time axis across all datasets to ensure consistent analyses and comparisons. The nature of the exercise was such that each dataset inherently began at a maximally flexed position—where the leg touched the bore of the scanner—and extended to maximum, where the leg was parallel to the scanner bore, before flexing back to the original position. This movement cycle, from -100\% for maximal flexion, through 0\% at full extension, and back to +100\% for maximal flexion, was consistent across all datasets. To facilitate the comparison and aggregation of the kinematic parameters, the normalized time axis was divided into bins of 10 degrees of leg rotation. Data were aggregated within each bin across all datasets, and the center of each bin was selected as the plotting point for graphical representation

For statistical analysis, a two-sample independent t-test was performed for each bin using the \texttt{stats} module from the  SciPy library. This analysis aimed at testing the null hypothesis that any observed differences in parameters under loaded and unloaded conditions were due to random chance. 


\section{Results}
\label{sec:results}

\subsection{Edge Tracking and Segmentation}

The measured alignment error per point for the femur and the tibia are presented separately in Figures \ref{fig:barfemur} and \ref{fig:bartibia}, respectively. 
\begin{figure}[H]
	\centering
	\includegraphics[width=0.7\linewidth]{bar_no_1_3_Femur_both.png}
	\caption{Bar chart illustrating the mean alignment error per point for edge tracking in femur datasets under loaded (orange) and unloaded (blue) conditions. Error bars represent the standard error of the mean (SEM) across frames for each condition within each dataset.}
	\label{fig:barfemur}
\end{figure}

\begin{figure}[H]
	\centering
	\includegraphics[width=0.7\linewidth]{bar_no_1_3_Tibia_both.png}
	\caption{Bar chart illustrating the mean alignment error per point for edge tracking in tibia datasets under loaded (orange) and unloaded (blue) conditions. Error bars represent the standard error of the mean (SEM) across frames for each condition within each dataset.}
	\label{fig:bartibia}
\end{figure}

A lower value of the y-axis in these bar charts indicates better accuracy of the edge tracking algorithm. Error bars reflect the standard error of the mean (SEM) for each condition within each dataset, demonstrating the precision of the mean alignment error estimates.  

For the femur datasets, the highest mean alignment error observed was 0.48 mm ± 0.04 mm, indicating that dataset 3 under load had the least precision in edge tracking. Conversely, the lowest mean alignment error was 0.24 mm ± 0.01 mm, suggesting that dataset 1 without load had the best edge tracking accuracy. On average, the mean alignment error for the loaded condition was 0.37 mm ± 0.02 mm, while for the unloaded condition, it was 0.33 mm ± 0.02 mm.

Similarly, for the tibia datasets, the highest mean alignment error observed was 0.51 mm ± 0.02 mm, implying that dataset 5 under load had the least precision in edge tracking for the tibia . Conversely, the lowest mean alignment error recorded was 0.27 mm ± 0.01 mm, suggesting that the edge tracking in the tibia worked best for dataset 2 also under load. On average, the mean alignment error for the loaded condition was 0.38 mm ± 0.02 mm, while for the unloaded condition, it was 0.32 mm ± 0.01 mm.

A paired sample t-test was conducted to compare the mean alignment errors per point between the loaded and unloaded conditions across the five datasets for the femur and tibia. The p-values obtained were 0.087 for the femur datasets and 0.057 for the tibia datasets. Given these p-values, the null hypothesis was not rejected for either dataset, suggesting no statistically significant difference in the mean alignment errors between the conditions at the conventional 0.05 significance level.
   
To illustrate how this alignment error translates to the actual performance of the segmentation, the worst performing dataset, which was the loaded case for the femur for dataset 3 is shown in Figure \ref{fig:d5wfem}: 

\begin{figure}[H]
	\centering
	\includegraphics[width=0.7\linewidth]{d5_W_fem}
	\caption{ The result of the proposed automatic segmentation of the femur (shown in green) for dataset 3 under load at various time points during the extension-flexion cycle. Frame 0 and Frame 31 represent the knee in its maximally flexed positions, making the start and end of the full cycle, respectively.}
	\label{fig:d5wfem}
\end{figure}

As for the tibia dataset, the worst performing dataset is illustrated similarly in Figure \ref{fig:d7wtib}. 

\begin{figure} [H]
	\centering
	\includegraphics[width=0.7\linewidth]{d7_W_tib}
	\caption{ The result of automatic segmentation of the tibia (shown in green) for dataset 5 under load at various time points during the extension-flexion cycle. Frame 0 and Frame 45 represent the knee in its maximally flexed positions, making the start and end of the full cycle, respectively.}
	\label{fig:d7wtib}
\end{figure}
 
These results demonstrate that, despite the highest magnitude of mean alignment error per point, its effect is not visually perceptible in the segmentation.   

\subsection{Biokinematic Parameter Extraction}

\textbf{Angle calculation}

Figure \ref{fig:anglegraphstickman} displays the calculated angle between the long axes of bone segments throughout the extension-flexion cycle. 
 
\begin{figure}[H]
	\centering
	\includegraphics[width=0.7\linewidth]{angle_no_13_stick}
	\caption{Average angle between the long axes of the bone segments with respect to time during the motion cycle under loaded and unloaded conditions. The x-axis ticks represent the centers of bins, each with a width of 10 percentage units. The shaded regions represent one standard deviation uncertainty across all the datasets. Angles greater than 180° imply hyperextension. Both loaded and unloaded conditions exhibit a similar pattern: the angle increases as the knee extends, peaking slightly beyond 180° at maximum extension, before decreasing symmetrically as the motion approaches 100\% flexion}
	\label{fig:anglegraphstickman}
\end{figure}

No significant differences were observed between the loaded and unloaded conditions for any of the bins, as given in Table \ref{tab:p_values_combined}. 

\textbf{Distance calculation }

The Euclidean distance between two points on the tibia and femur segments was measured throughout the flexion-extension cycle for both loaded and unloaded conditions. The aggregated results are shown in Figure \ref{fig:resultsdistancestickman}.
\begin{figure}[H]
	\centering
	\includegraphics[width=0.7\linewidth]{distance_no_13_stick}
	\caption{Plot showing the variation of the Euclidean distance between the anatomical landmarks on the femur and tibia with respect to time in the motion cycle. All distances are relative to the baseline measurement at -100\% flexion, set to 0 mm. The shaded region represents one standard deviation uncertainty across all datasets for each condition. In both loaded and unloaded conditions, the distance decreases during the extension half of the cycle, indicating that the segments are coming closer together, and then increases during the flexion half, suggesting the segments are moving further apart.}
	\label{fig:resultsdistancestickman}
\end{figure}

The null hypothesis was only rejected for the movement range between 0-10\% flexion. No significant differences were observed for the remaining bins, as noted in Table \ref{tab:p_values_combined}. 
\begin{table}[H]
	\centering
	\caption{Comparison of P-Values Across Flexion Percentage Ranges for Different Measurements}
	\label{tab:p_values_combined}
	\begin{tabular}{@{}ccc@{}}
		\toprule
		Flexion Percentage Range & p-value (Distance) & p-value (Angle) \\ \midrule
		-100\% to -90\% & 0.809 & 0.885 \\
		-90\% to -80\% & 0.518 & 0.762 \\
		-80\% to -70\% & 0.329 & 0.808 \\
		-70\% to -60\% & 0.914 & 0.781 \\
		-60\% to -50\% & 0.753 & 0.831 \\
		-50\% to -40\% & 0.535 & 0.825 \\
		-40\% to -30\% & 0.562 & 0.847 \\
		-30\% to -20\% & 0.915 & 0.808 \\
		-20\% to -10\% & 0.838 & 0.801 \\
		-10\% to 0\% & 0.516 & 0.973 \\
		0\% to 10\% & \textbf{0.016} & 0.703 \\
		10\% to 20\% & 0.129 & 0.918 \\
		20\% to 30\% & 0.617 & 0.969 \\
		30\% to 40\% & 0.595 & 0.928 \\
		40\% to 50\% & 0.737 & 0.863 \\
		50\% to 60\% & 0.576 & 0.899 \\
		60\% to 70\% & 0.305 & 0.883 \\
		70\% to 80\% & 0.626 & 0.913 \\
		80\% to 90\% & 0.977 & 0.898 \\
		90\% to 100\% & 0.574 & 0.942 \\
		\bottomrule
	\end{tabular}
	\begin{minipage}[t]{\linewidth} % Adjusting the width if necessary
		\bigskip
		\textbf{Note:} This table presents the p-values obtained from independent t-tests comparing the mean Euclidean distances and angles between loaded and unloaded conditions across predefined flexion percentage ranges. Each range represents an interval of 10\% in the extension-flexion cycle, with averages taken across all datasets. Significant p-values (p \textless 0.05) are highlighted in bold.
	\end{minipage}
\end{table}
\section{Discussion}
\label{sec:discussion}

\subsection{Edge Tracking and Segmentation}
Any kinematic analysis performed based on the pipeline introduced in this study hinges on the edge tracking step. A significant factor compromising the results of the edge tracking algorithm is the through-plane motion of the bones, which leads to inaccurate transformations. The algorithm is specifically designed to manage only rigid transformations within a single plane; therefore, any deviations introduced by through-plane motion significantly impairs edge detection and, consequently, segmentation accuracy.

Through-plane motion is particularly problematic for the tibia compared to the femur, primarily due to the tibia having more degrees of freedom, as illustrated in Figure \ref{fig:sixdegrees}, which details the six degrees of freedom of the tibia's movement relative to the femur. Despite the lower leg being secured at the ankle with Velcro straps and the knee cradled in a wedge positioner to limit movement predominantly to one plane, complete immobilization is not achievable. This limitation is especially pronounced in subjects with shorter legs, where even additional padding at the wedge positioner was insufficient to prevent all undesired motion. Although image localizers were employed prior to the scans in both extended and flexed positions to ensure that the slice moves only within a predetermined single plane, certain rotations cannot be fully corrected by simply angling the localizer images and may still be evident in the final images. 
Figure \ref{fig:edgebad} showcases this problem faced by the edge tracking algorithm: 

\begin{figure}[H]
	\centering
	\includegraphics[width=0.9\linewidth]{three_try2}
	\caption{Three frames at -100\%, 0\%, and 100\%  flexion are displayed (from left to right), showcasing the binary edge of the tibia boundary (in white) alongside with reference coordinates (in blue) during the edge tracking process. The images reveal that the algorithm struggles to accurately track the transformation between subsequent frames, especially evident in the misalignment of blue points near the proximal tibia in the middle frame (highlighted with a yellow circle). However, alignment improves significantly in the final frame as the knee returns to its original position. This variability is likely due to the leg's movement in and out of the scanning plane.}
	\label{fig:edgebad}
\end{figure}


Instances where significant deviations between transformed and target frames were observed like that shown above, led to the exclusion of the entire dataset from the analysis. This action was necessary because analyses based on misaligned data from any subject, whether under loaded or unloaded conditions, could result in misleading conclusions. Therefore, two datasets were discarded to ensure the reliability and accuracy of the study's findings.

The datasets included in the analysis  demonstrated satisfactory segmentation. Edge tracking performance was consistently robust for both loaded and unloaded conditions as well as between different bones (femur and tibia). The similar trends in mean alignment errors for both conditions suggest that the edge tracking algorithm was equally effective regardless of the mechanical loading on the joints. Specifically, the mean alignment error for the femur in the unloaded condition was 0.331 mm ± 0.018 mm, compared to 0.37 mm ± 0.02 mm in the loaded condition. Similarly, for the tibia, the unloaded condition showed a mean alignment error of 0.32 mm ± 0.02 mm, while in the loaded condition it was slightly higher at 0.38 mm ± 0.02 mm. Additionally, the fact that even the datasets with the highest magnitude of mean alignment error (0.51 mm for the tibia under load) did not visually exhibit significant segmentation flaws reinforces the notion that the algorithm can tolerate a certain degree of error without compromising the overall quality of the segmentation.

To provide a context for these values, it is noted that similar metrics have been reported in MRI-based measurements. For example, Rathnayaka et al.\,(2012) recorded an average alignment error per point of 0.23 mm in their study on the accuracy of MRI-generated 3D models of long bones \parencite{rathnayaka_quantification_2012}.  Furthermore, Van Oevelen et al. (2024) reported similar metrics in their study on meniscal dynamics and tibiofemoral kinematics using dynamic MRI. They quantified the precision of their segmentation using Average Surface Distance (ASD), with values for the medial meniscus ranging from 0.32 mm to 0.36 mm, and for the lateral meniscus from 0.41 mm to 0.70 mm, across different degrees of knee flexion \parencite{van_oevelen_relation_2024}.


\subsection{Angle Calculation}

The change in the angle between the long axes of the bones at different points during the motion cycle is consistent with the expected kinematics of the knee joint. The alignment of the femur and tibia is closest at full extension and diverges during flexion. The curve shape observed in Figure \ref{fig:anglegraphstickman} aligns with findings from similar studies \parencite{jeon_detection_2019}.

At full extension, the long axes of the bones are not perfectly parallel. This observation, likely influenced by the sagittal view used for measuring, aligns with findings from static scans where slight hyperextension is often reported \parencite{dai_comparing_2021}. 

\begin{figure}[H]
	\centering
	\includegraphics[width=0.7\linewidth]{dai_image}
	\caption{Femur (a) and tibia (b) shaft axes defined in static CT and T1-weighted MRI scans in the sagital view \parencite{dai_comparing_2021}. }
	\label{fig:daiimage}
\end{figure}

The null hypothesis was not rejected for any of the bins, as detailed in Table \ref{tab:p_values_combined}. This indicates that the method used in this study to calculate the angle was not affected by mechanical load.



\subsection{Distance Calculation}

Figure \ref{fig:resultsdistancestickman} shows the variation in the Euclidean distance between anatomical landmarks on the femur and tibia during the extension-flexion cycle. Prior studies, such as those by Westphal et al. (2013), have utilized dynamic MRI to investigate tibiofemoral kinematics under varied loading conditions. Their research, which examined the kinematic response to elastic versus inertial loading, reported no significant differences at maximum knee extension \parencite{westphal_load-dependent_2013}.

However, significant differences were observed in this study for the flexion percentage range between 0\% to 10\% with a P-value of 0.016. This would imply that external mechanical loading affects the spatial relationship between the femur and tibia, but only at the beginning of the flexion phase.  Unlike Westphal's study, which compared different types of loading, the current study focuses on varying magnitudes of the same type of loading. This distinction highlights how kinematic responses can differ significantly depending on the nature of the mechanical load applied.

This suggests that there is an underlying mechanism influencing the measured distance near terminal extension but not during other phases of motion. A likely candidate for this is the screw home mechanism (SHM) \parencite{kim_screw-home_2015}. The SHM involves the rotation of the tibia around the femur near terminal extension. It occurs due to the unequal lengths of the condyles. The medial femoral condyle is longer than the lateral condyle, which causes the tibia to rotate externally in the last stages of extension.   This rotation occurs to lock the knee in a stable, fully extended position. Then, when flexion starts during the second half of the cycle, the tibia rotates internally, which 'unlocks' the knee for further flexion.

It has been previously reported that the impact of external loading increases the magnitude of internal rotation of the tibia relative to the femur \parencite{myers_vivo_2012}. Not only does the magnitude of this rotation increase, but it has also been reported that the rotation occurs earlier during the flexion cycle under weight-bearing conditions \parencite{johal_tibio-femoral_2005}. Therefore, it seems that this internal rotation is more susceptible to changes in the distance between the defined anatomical landmarks due to external loading compared to external rotation. This susceptibility likely results in the significant differences observed during the initial phase of flexion, as the knee transitions from a fully extended, locked position to a flexed, unlocked state.  

Given these observations, it can be hypothesized that the response to external loading might serve as an indicator of SHM functionality. Notably, it has been demonstrated that SHM loss, characterized by reduced internal tibial rotation, occurs in patients with OA when compared to healthy controls, even without any applied external load \parencite{jeon_alteration_2020}. Additionally, quadriceps weakness has been identified as a significant risk factor for the development of OA \parencite{segal_is_2011}. This suggests that the external loading in this experimental setup, which induces quadriceps activation, could provide valuable diagnostic insights. Understanding the interaction between quadriceps strength and mechanical loading is crucial for detecting early signs of OA and developing targeted therapeutic strategies.


\textbf{Comparision with similar studies }

Other studies, such as those by Westphal et al.\,(2013) and Kaiser et al.\,(2013), utilized dynamic MRI combined with a knee loading device to examine the kinematics of the knee joint under load \autocites{westphal_load-dependent_2013}{kaiser_measurement_2013}. Given their focus on kinematic parameters extracted from 3D datasets, direct comparisons with the results of this study are challenging. However, the kinematic parameters defined in this study, even though restricted to two dimensions, serve as qualitative measures of the underlying mechanics of the knee, capturing the dynamic spatial relationships and alignment between the femur and tibia. This approach provides unique insights that complement existing research and contribute to a deeper understanding of knee biokinematics.  

\section{Conclusion}
\label{sec:conclusion}
This study set out to develop a semi-automated segmentation tool for analyzing dynamic MRI scans of the knee during flexion-extension cycles and to apply this tool to track and quantify biokinematic parameters. The findings illustrate the potential of this method to accurately measure bone alignment and distances between anatomical landmarks under different loading conditions.

Other imaging modalities, such as dynamic CT, have also been used to study tibiofemoral kinematics. A recent study established normative knee kinematics of healthy subjects (n=100) using a fully automatic workflow with dynamic CT \parencite{dunning_fully_2023}. While this approach is useful, it involves significant computational effort, particularly due to the reliance on deep learning-based neural networks for segmentation and registration. 

\textbf{Key Findings and Implications}

The metric used to quantify the precision of semi-automatic segmentation has been found comparable to those reported in the literature concerning MRI-based segmentation techniques. This semi-automated method is particularly advantageous for analyzing dynamic frames over time, making it highly suitable for clinical and research applications where advanced machine learning-based automatic segmentation techniques are not yet available for dynamic CINE images. The approach facilitates rapid and efficient analysis of a large number of frames and requires minimal computational power. It also does not require a static scan and all analysis can be done solely based on the dynamic scans. Moreover, once the bones are segmented across the full range of motion, additional biokinematic analyses can be conducted. For instance, extracting kinematic parameters such as anterior-posterior, superior-inferior translations of the tibia relative to the femur, and an indirect measure of internal tibial rotation. These analyses can provide comprehensive insights into joint kinematics, extending beyond the scope of this study.

The analysis of the angle between the long axes of the tibia and femur showed no significant differences between loaded and unloaded conditions. Any deviation from this trend while measuring patients with underlying conditions with OA could indicate potential pathological issues. Furthermore, as shown in a previous study, knees that have undergone anterior cruciate ligament (ACL) reconstruction demonstrate abnormal kinematic patterns. Specifically, inertial loading induced significant shifts in anterior and superior tibial translation and internal tibial rotation compared to passive motion \parencite{kaiser_effect_2017}. This suggests that the methods introduced in this study could be further developed to evaluate these kinematic changes in patients after ACL reconstruction. 

The distance measurement between anatomical landmarks on the tibia and femur revealed significant differences between loaded and unloaded condition during the early phase of the flexion. The observed differences in the spatial relationship between the femur and tibia under varying magnitudes of load may indicate the fucntional role of the screw home mechanism in modulating knee joint kinematics. These findings not only enhance our understanding of tibiofemoral kinematics under dynamic conditions but also underscore the potential diagnostic value of external loading in assessing SHM functionality and the early detection of OA. Future research should further explore the relationship between quadriceps strength, mechanical loading, and knee joint health to develop targeted interventions for preventing and managing OA.



\textbf{Limitations and Future Work}

During the course of the experiment, a couple of factors inherent to the experimental setup were identified that can introduce movement artifacts and compromise the image quality of dynamic MRI scans. The overall bulk movement of the leg during the scan, for example, can occur if the upper leg is not fixated properly. Improper fixation can allow the upper leg to lift, shift laterally, or even longitudinally during the course of the scan, further compromising the image quality. Ensuring that the thigh is securely positioned on the device with the thigh strap is critical for minimizing this movement.

Another important factor is muscle exhaustion. At the start of the exercise, volunteers might overexert themselves, leading to fatigue as the exercise progresses. This can cause variations in the range of motion and affect the position of the leg, resulting in inconsistent data. While the controlled exercise pace, guided by a metronome, aims to standardize the movement, individual differences in endurance can still introduce variability.

This study's methodology is also limited by its reliance on a single 2D slice. This approach does not fully capture the tibia's six degrees of freedom relative to the femur, potentially omitting critical aspects of knee kinematics. Future work should aim to extend this methodology to 3D, which would not only address current method's issues in edge tracking, but also allow for a complete assessment of knee joint kinematics, providing a more holistic understanding of its movements and interactions.

Additionally, the semi-automated segmentation method demonstrated here can be adapted to analyze patellofemoral kinematics. The patella shows well-defined edges in the images, making it a suitable candidate for this processing pipeline. Given the patella's significant role in knee mechanics \parencite{powers_evidence-based_2017}, this extension would provide valuable insights and complement the current analysis of tibiofemoral interactions.

In conclusion, the semi-automated segmentation process evaluated in this study offers a robust and efficient method for analyzing dynamic MRI scans of the knee. By enabling accurate tracking of biokinematic parameters and accommodating various analyses, it presents a valuable tool for both clinical diagnostics and biokinematic research. While current limitations highlight the need for 3D analysis to fully capture knee kinematics, the potential applications of this method are vast, paving the way for more comprehensive and insightful studies of knee joint mechanics.
% ----------------------------------------------------------------------------
% Bibliography
% ----------------------------------------------------------------------------
\cleardoublepage
\phantomsection
\addcontentsline{toc}{section}{\refname} % to add Bibliography to toc
\printbibliography

% --------------------------
%\cleardoublepage
%\begin{appendix}
%\section{Appendix}
%%
%%The non aggregated results for Figures \ref{fig:anglegraphstickman} and \ref{fig:resultsdistancestickman} are shown below: 
%%\begin{figure}[H]
%%	\centering
%%	\includegraphics[scale=0.42]{angle_non_agg}
%%	\caption{Non aggregated results for the angle between the long axis of the bone segments. Loaded and unloaded measurements are shown in their respective columns.}
%%	\label{fig:anglenonagg}
%%\end{figure}
%%
%%\begin{figure}[H]
%%	\centering
%%	\includegraphics[scale=0.42]{norm_non_agg}
%%	\caption{Non aggregated results for the euclidean distance between anatomical landmarks on the femur and tibia. Loaded and Unloaded conditions are shown in their respective columns.}
%%	\label{fig:normnonagg}
%%\end{figure}
%
%
%
%
%\end{appendix}

% ----------------------------------------------------------------------------
% Statutory declaration
% ----------------------------------------------------------------------------
%\makeThesisDeclaration

%\includepdf{Declaration of Academic Integrity (Eigenständigkeitserklärung).pdf}


\end{document}

