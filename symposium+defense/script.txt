Good afternoon everyone. I'm from the Medical Physics Group, and I'll be giving this talk in English. Our group is conducting research on the knee using both static and dynamic MRI. For this talk, I want to particularly focus on one algorithm we developed to automate the segmentation of tibia and femur from MRI cine images. 

Before diving into the algorithm, 
Let's start with why this research matters. Knee problems are a major health issue, affecting a significant portion of our population, especially as we age. Diseases that affect the knee like osteoarthritis can affect the way our knee moves, or alters the knee kinematics. But interestingly, changes in movement patterns might actually accelerate the progression of these conditions  We're looking at a vicious circle here. This isn't just true for OA; even in patients with ACL problems, it was found that their knee kinematics were altered, despite not showing obvious symptoms. That's why understanding tibiofemoral kinematics is crucial - it's key to breaking this cycle and improving knee health and function

Now, let's take a closer look at what we mean by tibiofemoral kinematics. 'Tibia' refers to your shin bone, while 'femur' is your thigh bone. Tibiofemoral kinematics simply means how the tibia moves relative to the femur. As you can see from the slide, this movement is quite complex. The knee joint actually has six degrees of freedom - that's six different ways the bones can move relative to each other. These are divided into three rotations and three translations. This complexity is why accurately measuring and understanding knee motion is both challenging and essential


To capture the complex motion of the knee, we use this custom MRI-safe device. It was designed and built in collaboration with our project partners at the Julius Wolff Institute in Berlin. Let me walk you through how it works:
First, the subject is positioned in the MRI scanner with their leg secured in this device. During the scan, they perform active knee flexion-extension cycles, guided by the steady beat of a metronome. This ensures consistent, repeatable motion.
Now, here's the clever part: The device is equipped with an optical sensor that precisely measures the knee's rotation angle in real time. This motion data is then synchronized with the MRI data we're collecting.
The result? We can retrospectively reconstruct a series of CINE frames, where each frame shows the knee at a specific angle in its flexion-extension cycle. It's like creating a smooth, detailed movie of the knee's motion inside the MRI.

Here are some reconstructed frames from our dynamic MRI sequence, showing the knee at different stages of flexion and extension. The basic idea of our segmentation pipeline is straightforward: we identify and isolate the inner boundary of the cortical bone for both the tibia and femur in the first frame. Then, we establish reference points along these boundaries and compute the transformation that moves these points from one frame to the next. We repeat this process, frame by frame, until we have the transformations for the entire motion sequence. Once we have these transformations, any segment we draw on the first frame can be automatically transformed for all subsequent frames, effectively automating the segmentation process.


Let's look at the process in more detail. First, we use edge detection to identify bone boundaries. Then, we apply connected component labeling to isolate specific structural features. We extract reference points along the labeled edges and compute transformation matrices to track bone movement across frames.
This process allows us to automatically segment the tibia and femur throughout the motion cycle. 

To evaluate the performance of our semi-automated method, we wanted to compare it with the traditional approach. So, we also performed manual segmentation of the same datasets and computed the angles between the long axes of the bones for both methods. 


Let's look at our results. On the left, you see graphs from five different datasets, each showing how the angle between the tibia and femur changes over time during the flexion-extension cycle. The blue line represents our semi-automated method, while the orange line shows the manual segmentation results. On the right, we have an aggregation of these five datasets. Notice how the shaded area, which represents the standard deviation, is consistently larger for the manual segmentation. This suggests that our algorithm produces smoother and more consistent results across different datasets.
Now, let's move to the next slide. Here, we've taken the derivative of the graphs on the left, which gives us the rate of change of the angle with respect to time. Essentially, this shows the speed at which each subject was moving their knee. In these graphs, the inconsistency of the manual segmentation becomes even more apparent.


The implications of this work are significant. It's part of a larger study involving 20 healthy participants and 20 post-ACL reconstruction patients, with baseline and follow-up measurements. Our method allows for efficient extraction of kinematic parameters for cohort analysis. Moreover, while we've demonstrated this in 2D, there's potential for 3D application, which could provide even more comprehensive insights into knee kinematics.
Thank you for your attention. I'd be happy to answer any questions





____


1. Understanding k-space and MRI Data

What is k-space?

    Definition: k-space is a mathematical space where MRI raw data is stored before being transformed into an image. It's a grid that represents the spatial frequencies of the object being imaged.
    Data Collection: In MRI, the scanner doesn't capture images directly. Instead, it collects data points in k-space by sampling the object's spatial frequencies using magnetic field gradients.

Your Data Dimensions Explained:

    352 (Data points per spoke): Each "spoke" is a line in k-space along which data is collected. Radial sampling collects data along multiple spokes radiating out from the center of k-space.
    276 (Number of spokes per k-space dataset): Each k-space dataset consists of 276 spokes, covering different angles in k-space.
    16 (Number of receive channels): MRI scanners use multiple coils (channels) to receive signals, enhancing signal-to-noise ratio.
    100 (Number of k-space repetitions): The entire set of k-space data was collected 100 times over the course of the experiment, corresponding to different moments during the knee movement.

2. Sorting k-space Data Based on Knee Angles

Why Sorting is Necessary:

    Dynamic Imaging: Since the knee is moving, each k-space dataset corresponds to a different knee position.
    Goal: To reconstruct images that show the knee at specific angles throughout its motion.

How Sorting Works:

    Collecting Angle Data: An optical sensor records the knee rotation angles concurrently with the MRI data acquisition.
    Grouping Spokes: For each k-space repetition, spokes are grouped based on the knee angle at the time they were acquired.
        2-Degree Intervals: The knee angle range is divided into segments of 2 degrees.
        Assigning Spokes to Angles: Spokes acquired when the knee is within a specific 2-degree angle range are grouped together.
    Direction of Movement:
        Flexion (Leg moving downward) and Extension (Leg moving upward) are processed separately because the knee mechanics differ in each direction.
        Determining Direction: By analyzing the slope of the angle data over time.

Result:

    You end up with multiple k-space datasets, each corresponding to a specific knee angle and movement direction.

3. Challenges in Reconstructing Images from Radial k-space Data

    Non-Cartesian Sampling: Radial sampling doesn't align with a regular grid, making standard reconstruction techniques less effective.
    Irregular Spacing: The spokes are not evenly distributed in k-space, complicating the direct application of the inverse Fourier transform.

4. RIESLING Toolbox

What is RIESLING?

    Definition: RIESLING is an open-source software toolbox designed specifically for reconstructing images from non-Cartesian k-space data, like radial or spiral sampling patterns.
    Function: It implements advanced algorithms to handle the complexities of non-uniformly sampled data.

Why Use RIESLING?

    Specialized Algorithms: It offers tools that are tailored for dealing with irregular k-space sampling.
    Customization: Allows for the incorporation of different reconstruction techniques and regularization methods.

5. The Role of ADMM in MRI Reconstruction

What is ADMM?

    Definition: The Alternating Direction Method of Multipliers (ADMM) is an optimization algorithm used to solve complex problems by breaking them into smaller, more manageable subproblems.
    Optimization Problem in MRI:
        Objective: Find an image that best fits the measured k-space data while satisfying certain constraints (like smoothness or sparsity).
        Mathematical Formulation: The reconstruction is framed as an optimization problem that balances data fidelity and regularization.

How ADMM Works in This Context:

    Splitting the Problem:
        Data Consistency Term: Ensures the reconstructed image agrees with the measured k-space data.
        Regularization Term: Imposes desired properties on the image (e.g., smoothness via TGV).
    Alternating Steps:
        Subproblem 1 (Data Consistency): Solves for an image that fits the k-space data, ignoring the regularization for this step.
        Subproblem 2 (Regularization): Adjusts the image to satisfy the regularization constraints, ignoring data fidelity for this step.
    Iteration:
        The algorithm alternates between these subproblems, gradually refining the image until convergence is achieved.

Benefits of Using ADMM:

    Efficiency: By breaking the problem into parts, each step becomes simpler and faster to compute.
    Flexibility: Can handle complex regularization terms like TGV.

6. TGV Regularization

What is TGV?

    Definition: Total Generalized Variation (TGV) is an advanced regularization technique that encourages smoothness in the image while preserving edges and fine details.
    Difference from TV:
        Total Variation (TV) regularization minimizes the total variation in the image but can introduce "staircase" artifacts.
        TGV addresses this by allowing for piecewise smooth variations without penalizing gradual intensity changes.

Why Use TGV in MRI Reconstruction?

    Noise Reduction: Helps suppress random noise in the image.
    Edge Preservation: Maintains sharp edges, which are crucial for anatomical details.
    Natural Appearance: Produces images that look more realistic compared to those processed with simpler methods.

7. Bringing It All Together

Reconstruction Pipeline in Your Thesis:

    Data Preparation:
        Raw k-space data is sorted based on knee angles and movement direction.
        Each sorted dataset represents a specific frame in the knee's motion.

    Image Reconstruction with RIESLING:
        Input: The sorted k-space datasets.
        Algorithm: RIESLING employs the ADMM algorithm with TGV regularization.

    ADMM in Action:
        Data Consistency Step: Ensures that the reconstructed image, when transformed back into k-space, matches the measured data for that specific knee angle.
        Regularization Step: Applies TGV to enforce smoothness and preserve edges in the image.

    Iteration and Convergence:
        These steps are repeated, with the image being updated each time, until the changes between iterations are minimal (convergence is reached).

    Output:
        A series of high-quality images, each representing the knee at a specific angle during flexion or extension.

8. Visualizing the Process

Analogy:

    Jigsaw Puzzle:
        Whole Puzzle: Reconstructing the complete image from k-space data is like assembling a large puzzle.
        ADMM's Role: It breaks the puzzle into smaller sections (subproblems), solves each section (data consistency and regularization), and then combines them.
        TGV's Role: Acts like a smoothing tool that ensures the pieces fit together seamlessly without distorting important features.

9. Connecting ADMM to the Actual Process

    Breaking Down the Problem:
        The "big problem" is reconstructing a high-quality image from incomplete and irregularly sampled k-space data.
    Solving Subproblems:
        Subproblem 1: Focuses on fidelity to the measured data.
        Subproblem 2: Focuses on image quality via regularization (TGV).
    Iterative Improvement:
        Each iteration refines the image, balancing between matching the data and enhancing image quality.

10. Conclusion

    RIESLING provides the framework and tools to handle complex, non-uniform k-space data.
    ADMM efficiently solves the challenging optimization problem by dividing it into manageable steps.
    TGV enhances image quality by reducing noise and preserving critical anatomical details.
    Result: High-resolution, dynamic MRI images of the knee throughout its range of motion, essential for analyzing knee mechanics and diagnosing potential issues.

Summary:

In your MRI reconstruction process:

    You collected raw k-space data while the knee was moving.
    Sorted this data based on knee angles and movement direction.
    Used RIESLING to reconstruct images from this data.
    RIESLING applied the ADMM algorithm with TGV regularization:
        ADMM efficiently solved the reconstruction problem by alternating between fitting the data and applying smoothness constraints.
        TGV ensured that the reconstructed images were smooth but still retained important details like edges.
    The final output was a series of images showing the knee at different angles, which could be used for further analysis in your thesis.